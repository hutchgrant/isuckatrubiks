{"version":3,"file":"shelf.dcb4cc90.js","sources":["../src/components/shelf/shelf.css?type=css","../src/components/icons/chevron-right.js","../src/components/icons/chevron-down.js","../src/components/shelf/shelf.js"],"sourcesContent":["const css = `:host h1,   :host h2,   :host h3,   :host h4,   :host h5,   :host h6 {     font-family: 'Source Sans Pro', sans-serif;   }   :host a {     text-decoration: none;     color: #2d3d3a;   }   :host a:hover,     :host a:focus {       color: black;     }   :host .list-wrap > :first-child {     display: grid;     grid-template-columns: auto 20px;     align-items: center;     font-size: 1.5em;     margin-block-start: 0.83em;     margin-block-end: 0.83em;     margin-inline-start: 0;     margin-inline-end: 0;     font-weight: bold;   }   @media (max-width: 768px) {   :host .list-wrap > :first-child {       padding-left: 10px;       padding-right: 10px   }     }   :host h2 {     display: block;     font-size: 1.5em;     margin-block-start: 0.83em;     margin-block-end: 0.83em;     margin-inline-start: 0;     margin-inline-end: 0;     font-weight: bold;   }   @media (max-width: 768px) {   :host h2 {       padding-left: 10px;       padding-right: 10px   }     }   :host div > ul {     padding-left: 0;   }   :host div > ul li {       list-style: none;     }   :host .list-wrap ul {     padding-left: 0;   }   :host .list-wrap ul li {       display: block;       margin-block-start: 1em;       margin-block-end: 1em;       margin-inline-start: 0;       margin-inline-end: 0;     }   :host .list-wrap ul li a {         cursor: pointer;       }   @media (max-width: 768px) {   :host .list-wrap ul {       padding-left: 10px   }     }   :host span {     pointer-events: none;   }   :host span > svg {       margin-top: 10px;       margin-left: auto;       height: 15px;     }   :host .hidden {     display: none !important;   }   :host .active {     color: red;   } `;\nexport default css;","import { svg } from 'lit';\n\nconst chevronRt = svg`\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 320 512\">\n    <path d=\"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505\n256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373\n24.568.001 33.941z\"/\n  ></svg>\n`;\n\nexport default chevronRt;","import { svg } from 'lit';\n\nconst chevronDwn = svg`\n  <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\">\n    <path d=\"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224\n284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373\n9.372-24.569 9.372-33.942 0z\"/>\n  </svg>\n`;\n\nexport default chevronDwn;","import { css, html, LitElement, unsafeCSS } from 'lit';\nimport client from '@greenwood/plugin-graphql/core/client';\nimport MenuQuery from '@greenwood/plugin-graphql/queries/menu';\nimport shelfCss from './shelf.css?type=css';\nimport chevronRt from '../icons/chevron-right.js';\nimport chevronDwn from '../icons/chevron-down.js';\n\nclass Shelf extends LitElement {\n\n  static get properties() {\n    return {\n      page: {\n        type: String\n      }\n    };\n  }\n\n  static get styles() {\n    return css`\n      ${unsafeCSS(shelfCss)}\n    `;\n  }\n\n  constructor() {\n    super();\n    this.page = '';\n    this.selectedIndex = '';\n    this.shelfList = [];\n  }\n\n  async connectedCallback() {\n    super.connectedCallback();\n    this.collapseAll();\n  }\n\n  expandRoute(path) {\n    let routeShelfListIndex = this.shelfList.findIndex(item => {\n      let expRoute = new RegExp(`^${path}$`);\n      return expRoute.test(item.route);\n    });\n\n    if (routeShelfListIndex > -1) {\n      this.shelfList[routeShelfListIndex].selected = true;\n      this.selectedIndex = routeShelfListIndex;\n    }\n  }\n\n  collapseAll() {\n    this.shelfList = this.shelfList.map(item => {\n      item.selected = false;\n      return item;\n    });\n  }\n\n  toggleSelectedItem() {\n    let selectedShelfListIndex = this.shelfList.findIndex((list, index) => index === this.selectedIndex);\n\n    if (selectedShelfListIndex > -1) {\n      this.shelfList[selectedShelfListIndex].selected = !this.shelfList[selectedShelfListIndex].selected;\n    }\n  }\n\n  setSelectedItem(evt) {\n    const previousSelected = this.selectedIndex;\n\n    this.selectedIndex = parseInt(evt.target.id.substring(6, evt.target.id.length), 10);\n\n    if (this.selectedIndex === previousSelected) {\n      this.selectedIndex = '';\n    }\n\n    this.toggleSelectedItem();\n  }\n\n  handleShelfClick(evt) {\n    // collapse all other items\n    this.collapseAll();\n    // set selected to index\n    this.setSelectedItem(evt);\n    // force re-render\n    this.requestUpdate();\n  }\n\n  async fetchShelfData() {\n    return await client.query({\n      query: MenuQuery,\n      variables: {\n        name: 'side',\n        route: `/${this.page}/`,\n        order: 'index_asc'\n      }\n    });\n  }\n\n  async updated(changedProperties) {\n    if (changedProperties.has('page') && this.page !== '' && this.page !== '/') {\n      const response = await this.fetchShelfData();\n\n      this.shelfList = response.data.menu.children.map((item) => {\n        return {\n          ...item.item,\n          children: item.children\n        };\n      });\n      this.expandRoute(window.location.pathname);\n      this.requestUpdate();\n    }\n  }\n\n  renderList() {\n    /* eslint-disable indent */\n    const renderListItems = (mainRoute, children, selected) => {\n      let listItems = '';\n\n      if (children && children.length > 0) {\n        listItems = html`\n          <ul>\n            ${children.map((child) => {\n              return html`\n                <li class=\"${selected ? '' : 'hidden'}\">\n                  <a href=\"${mainRoute}${child.item.route}\">${child.item.label}</a>\n                </li>\n              `;\n            })}\n          </ul>\n        `;\n      }\n\n      return listItems;\n    };\n\n    /* eslint-enable */\n    return this.shelfList.map((item, index) => {\n      let id = `index_${index}`;\n      let chevron = item.children && item.children.length > 0\n        ? item.selected === true ? chevronDwn : chevronRt\n        : '';\n\n      return html`\n        <li class=\"list-wrap\">\n          <div>\n            <a href=\"${item.route}\">${item.label}</a>\n            <a id=\"${id}\" @click=\"${this.handleShelfClick}\"><span class=\"pointer\">${chevron}</span></a>\n          </div>\n\n          ${renderListItems(item.route, item.children, item.selected)}\n        </li>\n      `;\n    });\n  }\n\n  render() {\n    return html`\n      <div>\n        <ul>\n          ${this.renderList()}\n        </ul>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define('app-shelf', Shelf);\n"],"names":["chevronRt","svg","chevronDwn","customElements","define","LitElement","properties","page","type","String","styles","css","unsafeCSS","constructor","super","this","selectedIndex","shelfList","async","connectedCallback","collapseAll","expandRoute","path","routeShelfListIndex","findIndex","item","RegExp","test","route","selected","map","toggleSelectedItem","selectedShelfListIndex","list","index","setSelectedItem","evt","previousSelected","parseInt","target","id","substring","length","handleShelfClick","requestUpdate","client","query","MenuQuery","variables","name","order","changedProperties","has","response","fetchShelfData","data","menu","children","window","location","pathname","renderList","chevron","html","label","mainRoute","listItems","child","renderListItems","render"],"mappings":"wHAAA,MCEMA,EAAYC,CAAG;;;;;;ECAfC,EAAaD,CAAG;;;;;;ECgKtBE,eAAeC,OAAO,YA3JtB,cAAoBC,EAEPC,wBACT,MAAO,CACLC,KAAM,CACJC,KAAMC,QAGX,CAEUC,oBACT,OAAOC,CAAG;QACNC,EHnBI;KGqBT,CAEDC,cACEC,QACAC,KAAKR,KAAO,GACZQ,KAAKC,cAAgB,GACrBD,KAAKE,UAAY,EAClB,CAEDC,0BACEJ,MAAMK,oBACNJ,KAAKK,aACN,CAEDC,YAAYC,GACV,IAAIC,EAAsBR,KAAKE,UAAUO,WAAUC,GAClC,IAAIC,OAAO,IAAIJ,MACdK,KAAKF,EAAKG,SAGxBL,GAAuB,IACzBR,KAAKE,UAAUM,GAAqBM,UAAW,EAC/Cd,KAAKC,cAAgBO,EAExB,CAEDH,cACEL,KAAKE,UAAYF,KAAKE,UAAUa,KAAIL,IAClCA,EAAKI,UAAW,EACTJ,IAEV,CAEDM,qBACE,IAAIC,EAAyBjB,KAAKE,UAAUO,WAAU,CAACS,EAAMC,IAAUA,IAAUnB,KAAKC,gBAElFgB,GAA0B,IAC5BjB,KAAKE,UAAUe,GAAwBH,UAAYd,KAAKE,UAAUe,GAAwBH,SAE7F,CAEDM,gBAAgBC,GACd,MAAMC,EAAmBtB,KAAKC,cAE9BD,KAAKC,cAAgBsB,SAASF,EAAIG,OAAOC,GAAGC,UAAU,EAAGL,EAAIG,OAAOC,GAAGE,QAAS,IAE5E3B,KAAKC,gBAAkBqB,IACzBtB,KAAKC,cAAgB,IAGvBD,KAAKgB,oBACN,CAEDY,iBAAiBP,GAEfrB,KAAKK,cAELL,KAAKoB,gBAAgBC,GAErBrB,KAAK6B,eACN,CAED1B,uBACE,aAAa2B,EAAOC,MAAM,CACxBA,MAAOC,EACPC,UAAW,CACTC,KAAM,OACNrB,MAAO,IAAIb,KAAKR,QAChB2C,MAAO,cAGZ,CAEDhC,cAAciC,GACZ,GAAIA,EAAkBC,IAAI,SAAyB,KAAdrC,KAAKR,MAA6B,MAAdQ,KAAKR,KAAc,CAC1E,MAAM8C,QAAiBtC,KAAKuC,iBAE5BvC,KAAKE,UAAYoC,EAASE,KAAKC,KAAKC,SAAS3B,KAAKL,IACzC,IACFA,EAAKA,KACRgC,SAAUhC,EAAKgC,aAGnB1C,KAAKM,YAAYqC,OAAOC,SAASC,UACjC7C,KAAK6B,eACN,CACF,CAEDiB,aAuBE,OAAO9C,KAAKE,UAAUa,KAAI,CAACL,EAAMS,KAC/B,IAAIM,EAAK,SAASN,IACd4B,EAAUrC,EAAKgC,UAAYhC,EAAKgC,SAASf,OAAS,GAChC,IAAlBjB,EAAKI,SAAoB3B,EAAaF,EACtC,GAEJ,OAAO+D,CAAI;;;uBAGMtC,EAAKG,UAAUH,EAAKuC;qBACtBxB,cAAezB,KAAK4B,2CAA2CmB;;;YA/BxD,EAACG,EAAWR,EAAU5B,KAC5C,IAAIqC,EAAY,GAgBhB,OAdIT,GAAYA,EAASf,OAAS,IAChCwB,EAAYH,CAAI;;cAEVN,EAAS3B,KAAKqC,GACPJ,CAAI;6BACIlC,EAAW,GAAK;6BAChBoC,IAAYE,EAAM1C,KAAKG,UAAUuC,EAAM1C,KAAKuC;;;;WAQ5DE,CAAS,EAiBVE,CAAgB3C,EAAKG,MAAOH,EAAKgC,SAAUhC,EAAKI;;OAErD,GAEJ,CAEDwC,SACE,OAAON,CAAI;;;YAGHhD,KAAK8C;;;KAId"}