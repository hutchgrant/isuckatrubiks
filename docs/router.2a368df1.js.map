{"version":3,"file":"router.2a368df1.js","sources":["../node_modules/@greenwood/cli/src/lib/router.js"],"sourcesContent":["/* eslint-disable no-underscore-dangle */\n\ndocument.addEventListener('click', async function(e) {\n  const currentUrl = window.location;\n  // https://developer.mozilla.org/en-US/docs/Web/API/Event/composedPath\n  const href = e.composedPath && e.composedPath()[0].tagName === 'A'\n    ? e.composedPath()[0].href\n    : '';\n\n  // best case \"guess\" is that if the link originates on the current site when resolved by the browser\n  // treat it as a client side route, ex:  /about/, /docs/ and trigger the client side router\n  // https://github.com/ProjectEvergreen/greenwood/issues/562\n  const isOnCurrentDomain = href.indexOf(currentUrl.hostname) >= 0 || href.indexOf('localhost') >= 0;\n  const canClientSideRoute = href !== '' && isOnCurrentDomain;\n\n  if (canClientSideRoute) {\n    e.preventDefault();\n\n    const targetUrl = new URL(href, currentUrl.origin);\n    const routerOutlet = Array.from(document.getElementsByTagName('greenwood-route')).filter(outlet => {\n      return outlet.getAttribute('data-route') === targetUrl.pathname;\n    })[0];\n\n    // maintain the app shell if we are navigating between pages that are built from the same page template\n    // also, some routes may be SSR, so we may not always match on a static route\n    if (routerOutlet && routerOutlet.getAttribute('data-template') === window.__greenwood.currentTemplate) {\n      const { hash, pathname } = targetUrl;\n\n      if (currentUrl.pathname !== pathname) {\n        await routerOutlet.loadRoute();\n\n        history.pushState({}, '', pathname);\n      }\n\n      if (hash !== '') {\n        currentUrl.hash = hash;\n      }\n    } else {\n      // this page uses is a completely different page template from the current page\n      // so just load the new page\n      window.location.href = href;\n    }\n  }\n});\n\nwindow.addEventListener('popstate', () => {\n  try {\n    const targetRoute = window.location;\n    const routerOutlet = Array.from(document.getElementsByTagName('greenwood-route')).filter(outlet => {\n      return outlet.getAttribute('data-route') === targetRoute.pathname;\n    })[0];\n\n    if (routerOutlet) {\n      routerOutlet.loadRoute();\n    }\n  } catch (err) {\n    console.error('Unexpected error trying to go back.', err);\n  }\n});\n\nclass RouteComponent extends HTMLElement {\n  async loadRoute() {\n    const key = this.getAttribute('data-key');\n\n    await fetch(key)\n      .then(res => res.text())\n      .then((response) => {\n        document.getElementsByTagName('router-outlet')[0].innerHTML = response;\n      });\n  }\n}\n\nclass RouterOutletComponent extends HTMLElement { }\n\ncustomElements.define('greenwood-route', RouteComponent);\ncustomElements.define('router-outlet', RouterOutletComponent);"],"names":["document","addEventListener","async","e","currentUrl","window","location","href","composedPath","tagName","isOnCurrentDomain","indexOf","hostname","preventDefault","targetUrl","URL","origin","routerOutlet","Array","from","getElementsByTagName","filter","outlet","getAttribute","pathname","__greenwood","currentTemplate","hash","loadRoute","history","pushState","targetRoute","err","console","error","RouteComponent","HTMLElement","key","this","fetch","then","res","text","response","innerHTML","RouterOutletComponent","customElements","define"],"mappings":"AAEAA,SAASC,iBAAiB,SAASC,eAAeC,GAChD,MAAMC,EAAaC,OAAOC,SAEpBC,EAAOJ,EAAEK,cAAgD,MAAhCL,EAAEK,eAAe,GAAGC,QAC/CN,EAAEK,eAAe,GAAGD,KACpB,GAKEG,EAAoBH,EAAKI,QAAQP,EAAWQ,WAAa,GAAKL,EAAKI,QAAQ,cAAgB,EAGjG,GAFoC,KAATJ,GAAeG,EAElB,CACtBP,EAAEU,iBAEF,MAAMC,EAAY,IAAIC,IAAIR,EAAMH,EAAWY,QACrCC,EAAeC,MAAMC,KAAKnB,SAASoB,qBAAqB,oBAAoBC,QAAOC,GAChFA,EAAOC,aAAa,gBAAkBT,EAAUU,WACtD,GAIH,GAAIP,GAAgBA,EAAaM,aAAa,mBAAqBlB,OAAOoB,YAAYC,gBAAiB,CACrG,MAAMC,KAAEA,EAAIH,SAAEA,GAAaV,EAEvBV,EAAWoB,WAAaA,UACpBP,EAAaW,YAEnBC,QAAQC,UAAU,CAAA,EAAI,GAAIN,IAGf,KAATG,IACFvB,EAAWuB,KAAOA,EAE1B,MAGMtB,OAAOC,SAASC,KAAOA,CAE1B,CACH,IAEAF,OAAOJ,iBAAiB,YAAY,KAClC,IACE,MAAM8B,EAAc1B,OAAOC,SACrBW,EAAeC,MAAMC,KAAKnB,SAASoB,qBAAqB,oBAAoBC,QAAOC,GAChFA,EAAOC,aAAa,gBAAkBQ,EAAYP,WACxD,GAECP,GACFA,EAAaW,WAEhB,CAAC,MAAOI,GACPC,QAAQC,MAAM,sCAAuCF,EACtD,KAGH,MAAMG,UAAuBC,YAC3BlC,kBACE,MAAMmC,EAAMC,KAAKf,aAAa,kBAExBgB,MAAMF,GACTG,MAAKC,GAAOA,EAAIC,SAChBF,MAAMG,IACL3C,SAASoB,qBAAqB,iBAAiB,GAAGwB,UAAYD,CAAQ,GAE3E,EAGH,MAAME,UAA8BT,aAEpCU,eAAeC,OAAO,kBAAmBZ,GACzCW,eAAeC,OAAO,gBAAiBF"}